---
export const prerender = false;
import Header from "../components/Header.astro";
import Hero from "../components/Hero.astro";
import About from "../components/About.astro";
import Projects from "../components/Projects.astro";
import Experience from "../components/Experience.astro";
import Education from "../components/Education.astro";
import Footer from "../components/Footer.astro";
import { fetchSiteConfig } from "../../../_shared/config";
import "../styles/global.css";

const portfolioId = Astro.url.searchParams.get('portfolioId');
const siteConfig = await fetchSiteConfig(portfolioId);
const notFound = !portfolioId || !siteConfig;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={siteConfig?.description || 'Developer portfolio'} />
    <!-- Theming for browsers using the portfolio accent color -->
    <meta name="theme-color" content={siteConfig?.accentColor || '#22c55e'} />
    <meta name="msapplication-navbutton-color" content={siteConfig?.accentColor || '#22c55e'} />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />
    <title>{siteConfig ? `${siteConfig?.name} - ${siteConfig?.title}` : 'Portfolio Not Found'}</title>
  </head>
  <body style={`--accent: ${siteConfig?.accentColor || '#22c55e'}`}>
    {
      notFound ? (
        <main style="min-height: 100vh; display:grid; place-items:center; background:#0b0f1a; color:#e5e7eb;">
          <section style="text-align:center; max-width: 720px; padding: 2rem;">
            <h1 style="font-size: clamp(2.25rem, 6vw, 4rem); line-height:1.05; margin:0 0 .75rem; font-weight:800;">Portfolio Not Found</h1>
            <p style="color:#9ca3af; font-size: clamp(1rem, 1.2vw, 1.15rem); margin: 0 0 1.5rem;">The requested portfolio is private or does not exist.</p>
            <a href="/" style="display:inline-block; padding:.7rem 1rem; border-radius:999px; border:1px solid rgba(148,163,184,.35); color:#e5e7eb; text-decoration:none; background-color: rgba(255,255,255,.06);">‚Üê Back to Home</a>
          </section>
        </main>
      ) : (
        <>
          <Header siteConfig={siteConfig} />
          <section>
            <Hero siteConfig={siteConfig} />
            <About siteConfig={siteConfig} />
            <Projects siteConfig={siteConfig} />
            <Experience siteConfig={siteConfig} />
            <Education siteConfig={siteConfig} />
          </section>
          <Footer siteConfig={siteConfig} />
          {siteConfig?.scripts && siteConfig.scripts.length > 0 && (
            <>
              {siteConfig.scripts.map((src) => <script src={src} defer />)}
            </>
          )}
        </>
      )
    }
  </body>
</html>
